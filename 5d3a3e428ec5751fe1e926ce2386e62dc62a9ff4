{
  "comments": [
    {
      "key": {
        "uuid": "5a682502_d97917fe",
        "filename": "jjb/yardstick/yardstick-daily-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 22,
      "author": {
        "id": 7067
      },
      "writtenOn": "2018-09-25T13:02:36Z",
      "side": 1,
      "message": "Assuming this is meant to pull the gambia image from docker hub, we will first have to:\n- create and push gambia image to docker hub, under reused \u0027stable\u0027 tag\n- create and push fraser image to docker hub, under new \u0027fraser\u0027 tag (for L27)\n\nThis will make the \u0027stable\u0027 tag suddenly jump from previous-stable (i.e. fraser contents) to new-stable (i.e. gambia contents \u003d master/latest contents at cut-off date). Not so \"stable\" ;-)\n\nQuestion: shouldn\u0027t we get rid of \u0027stable\u0027 tag on docker hub, and instead use explicit \u0027gambia\u0027 tag here?\nThat would make L22 already consistent with L27 and future-proof for gambia when hunter will be prepared.\n\nIn terms of users of the \u0027stable\u0027 tag, I see this YAML file. There might be other users that I\u0027m not aware of, but I didn\u0027t dig further for them.\nRegarding Yarstick/NSB, in ansible/nsb_setup.yml:\n- Yarstick master defaults to \u0027opnfv/yardstick:latest\u0027 tag [1]\n- Yarstick stable/fraser uses hard-coded \u0027opnfv/yardstick:opnfv-6.2.1\u0027 tag [2]\n\n[1] https://gerrit.opnfv.org/gerrit/gitweb?p\u003dyardstick.git;a\u003dblob;f\u003dansible/nsb_setup.yml;h\u003dfcde1d1b233254336e8575003954974300325019;hb\u003drefs/heads/master#l40\n[2] https://gerrit.opnfv.org/gerrit/gitweb?p\u003dyardstick.git;a\u003dblob;f\u003dansible/nsb_setup.yml;h\u003dd1ebfa3db1cd098e5b101ec80f626afae8d7403f;hb\u003drefs/heads/stable/fraser#l40",
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a682502_62dbe8ed",
        "filename": "jjb/yardstick/yardstick-daily-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 22,
      "author": {
        "id": 7067
      },
      "writtenOn": "2018-09-28T12:01:37Z",
      "side": 1,
      "message": "See https://jira.opnfv.org/browse/YARDSTICK-1137 for another example why explicit release-name tags (\"fraser\", \"gambia\"...) would be better than the jumping \"stable\" tag.\n\nTo summarize, I would prefer L22 to read:\ndocker-tag: \u0027gambia\u0027",
      "parentUuid": "5a682502_d97917fe",
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a682502_9fdbff1a",
        "filename": "jjb/yardstick/yardstick-daily-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 22,
      "author": {
        "id": 331
      },
      "writtenOn": "2018-09-30T13:33:35Z",
      "side": 1,
      "message": "I think your understanding is right, stable is no actually stable, it\u0027s used as \"to be stable\", then for each release, tag the docker image with the release version tag e.g. opnfv-6.1.0.\nAs you can see in [1], this is for the docker build job. It currently default use \"stable\" if there\u0027s no release tag in the git repo.\n[1] https://git.opnfv.org/releng/tree/jjb/releng/opnfv-docker.sh#n118\nIf we change \"stable\" to \"gambia\", the logic in [1] also need to change, but still we need to keep the tags of docker for nsb_setup.yml. So my suggestion would be that we can keep it this way.",
      "parentUuid": "5a682502_d97917fe",
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a682502_73c45c92",
        "filename": "jjb/yardstick/yardstick-daily-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 22,
      "author": {
        "id": 7067
      },
      "writtenOn": "2018-10-01T23:05:30Z",
      "side": 1,
      "message": "Agreed, the docker tag we need to pull for gambia daily jobs is \u0027stable\u0027, because that\u0027s what jjb/releng/opnfv-docker.sh will push by default (when neither from master branch, nor for a specific release tag).\nSo I acknowledge your point, and agree that L18-L22 are correct.\nUntil the logic in jjb/releng/opnfv-docker.sh is reworked, but that\u0027s another story...",
      "parentUuid": "5a682502_9fdbff1a",
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a682502_135ec8e6",
        "filename": "jjb/yardstick/yardstick-daily-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 7067
      },
      "writtenOn": "2018-10-01T23:05:30Z",
      "side": 1,
      "message": "However, I could not find how/when this \u0027fraser\u0027 docker tag would be pushed. Sorry to be a pain ;-)\nEven with GERRIT_REFNAME set to \u0027fraser\u0027, or with a \"retag fraser\" gerrit comment, which both would properly set RELEASE_VERSION then DOCKER_TAG to \u0027fraser\u0027, the \"git checkout fraser\" command would fail. Using \u0027stable/fraser\u0027 would work for git, but would not be a valid docker tag according to [2].\nThis is an issue, because the \u0026fraser anchor on L23 is aliased for several PODs below on L52, L57, L73, L78, L94, L99, L115, L120, L136, L141, L152, L175, L190 and L200.\n\nI think that L23-L27 should ultimately be removed, and that s/fraser/gambia/ should be applied on the whole file. This would be consistent with what was done for previous releases, see [3] and [4].\n\nBut in turn, this will require [5] to have been merged, then [6] to be modified (or duplicated) for gambia (and \u0027*other-receivers\u0027 to be changed to \u0027*yardstick-receivers\u0027), in order to have the gambia docker image built and pushed with \u0027stable\u0027 tag, as needed by L22.\n\nDuring this transition phase, and in order to have this commit merged soon, so that the yardstick-verify-gambia and yardstick-merge-gambia jobs are made available to Jenkins, I suggest to temporarily use \u0027ovp-2.0.0\u0027 as the docker tag on L27. This is currently a synonym for most recent \u0027stable/fraser\u0027, see [7] and [8].\n\n[2] https://docs.docker.com/engine/reference/commandline/tag/\n[3] https://gerrit.opnfv.org/gerrit/42257\n[4] https://gerrit.opnfv.org/gerrit/54737\n[5] https://gerrit.opnfv.org/gerrit/63047\n[6] https://gerrit.opnfv.org/gerrit/#/c/63047/1/jjb/releng/opnfv-docker.yaml@292\n[7] https://gerrit.opnfv.org/gerrit/gitweb?p\u003dyardstick.git;a\u003dshortlog;h\u003drefs/heads/stable/fraser\n[8] https://hub.docker.com/r/opnfv/yardstick/tags/",
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a682502_794603c1",
        "filename": "jjb/yardstick/yardstick-project-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 20,
      "author": {
        "id": 7067
      },
      "writtenOn": "2018-09-25T13:02:36Z",
      "side": 1,
      "message": "This anchor does not seem to be used by any alias in this file, so we should be safe not creating it.",
      "range": {
        "startLine": 20,
        "startChar": 16,
        "endLine": 20,
        "endChar": 23
      },
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a682502_d912b7b3",
        "filename": "jjb/yardstick/yardstick-project-jobs.yaml",
        "patchSetId": 3
      },
      "lineNbr": 24,
      "author": {
        "id": 7067
      },
      "writtenOn": "2018-09-25T13:02:36Z",
      "side": 1,
      "message": "Similarly, the fraser anchor was not used and just got deleted.",
      "revId": "5d3a3e428ec5751fe1e926ce2386e62dc62a9ff4",
      "serverId": "bbac25d2-bf60-4904-9ba8-a72fc000d6c5",
      "unresolved": false
    }
  ]
}