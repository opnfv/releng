########################
# Job configuration for apex
########################
- project:

    name: 'opnfv-apex'

    installer: 'apex'

    controller:
        - 'odl'
        - 'onos'
        - 'opencontrail'

    pod: 'intelpod2-jumphost'

    stream:
        - master:
            branch: 'master'
            gs-pathname: ''

    jobs:
        - 'opnfv-apex-{controller}-{pod}-daily-{stream}'
        - 'opnfv-apex-deploy-{pod}-daily-{stream}'

########################
# job templates
########################
- job-template:
    name: 'opnfv-apex-{controller}-{pod}-daily-{stream}'

    disabled: true

    concurrent: false

    parameters:
        - project-parameter:
            project: '{installer}'
        - '{pod}-defaults'
        - '{installer}-defaults':
            controller: '{controller}'

    scm:
        - git-scm:
            credentials-id: '{ssh-credentials}'
            refspec: ''
            branch: '{branch}'

    builders:
        - trigger-builds:
          - project: 'opnfv-apex-daily-deploy-{stream}'
            git-revision: true
            block: true
            predefined-parameters:
                CONTROLLER={controller}

- job-template:
    name: 'opnfv-apex-deploy-{pod}-daily-{stream}'

    disabled: true

    concurrent: false

    wrappers:
        - build-name:
            name: '$BUILD_NUMBER: {installer} $CONTROLLER'

    parameters:
        - project-parameter:
            project: '{installer}'
        - '{pod}-defaults'
        - '{installer}-defaults'

    scm:
        - git-scm:
            credentials-id: '{ssh-credentials}'
            refspec: ''
            branch: '{branch}'

    builders:
        - shell: |
            #!/bin/bash
            echo "Hello World from OPNFV $INSTALLER_TYPE"
            echo "Running $INSTALLER_TYPE with controller $CONTROLLER"
