[tox]
envlist = docs,pep8,pylint,py27

[testenv]
usedevelop = True
deps =
  -r{toxinidir}/requirements.txt
  -r{toxinidir}/test-requirements.txt
  git+https://gerrit.opnfv.org/gerrit/releng#egg=opnfv&subdirectory=modules
commands = nosetests --with-xunit \
  --with-coverage \
  --cover-tests \
  --cover-package=reporting \
  --cover-xml \
  --cover-html \
  reporting/tests/unit

[testenv:docs]
basepython = python2.7
commands = sphinx-build -W -b html docs/ docs/_build 

[testenv:pep8]
basepython = python2.7
commands = flake8

[testenv:pylint]
basepython = python2.7
whitelist_externals = bash
modules =
    reporting.utils
    reporting.functest
    reporting.yardstick
    reporting.storperf
    reporting.qtip
commands =
  bash -c "\
    pylint -f parseable --disable=locally-disabled functest | \
    tee pylint.out | sed -ne '/Raw metrics/,//p'"
  pylint --disable=locally-disabled --reports=n {[testenv:pylint]modules}
